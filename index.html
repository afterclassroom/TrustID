<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeriTrust - Digital ID & Content Verification</title>
    <link href="https://kit-pro.fontawesome.com/releases/v5.15.3/css/pro.min.css" rel="stylesheet" type="text/css">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <style>
        /* IBM Carbon g10 Theme (Light Mode) */
        :root {
            --bg-primary: #ffffff;
            --bg-card: #fff;
            --border-color: #e0e0e0;
            --text-primary: #161616;
            --text-secondary: #525252;
            --text-tertiary: #8d8d8d;
            --ibm-blue-60: #0F62FE;
            --ibm-blue-50: #4589FF;
            --ibm-blue-30: #A6C8FF;
            --bg-surface: #f9f9f9;
        }
        
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        .card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, var(--ibm-blue-60), var(--ibm-blue-50));
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary:hover {
            opacity: 0.9;
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background-color: var(--bg-card);
        }
        
        .input-field {
            width: 100%;
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 0.5rem 0.75rem;
            color: var(--text-primary);
            font-size: 0.875rem;
        }
        
        .input-field:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--ibm-blue-60);
        }
        
        .input-field::placeholder {
            color: var(--text-tertiary);
        }
        
        .pill {
            display: inline-flex;
            align-items: center;
            border: 1px solid var(--border-color);
            border-radius: 9999px;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .navbar {
            background-color: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .gauge-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ibm-blue-60), var(--ibm-blue-50));
            transition: width 0.5s ease;
        }
        
        .verified-badge {
            background-color: #d0f0e4;
            border: 1px solid #24a46d;
            border-radius: 0.75rem;
            padding: 0.75rem;
        }
        
        .info-section {
            background-color: #e5edff;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 0.75rem;
        }
        
        /* Mobile Menu */
        .mobile-menu {
            display: none;
            position: fixed;
            top: 65px;
            left: 0;
            right: 0;
            background-color: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem;
            z-index: 9;
        }
        
        .mobile-menu.active {
            display: block;
        }
        
        .hamburger {
            display: none;
            flex-direction: column;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
        }
        
        .hamburger span {
            width: 24px;
            height: 2px;
            background-color: var(--text-primary);
            transition: all 0.3s;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .navbar .flex.items-center.gap-2 {
                display: none;
            }
            
            .hamburger {
                display: flex;
            }
            
            .mobile-menu .nav-tab {
                display: block;
                width: 100%;
                text-align: left;
                margin-bottom: 0.5rem;
            }
            
            .flex.items-center.justify-between.gap-4 {
                flex-direction: column;
                align-items: flex-start !important;
            }
            
            .flex.items-center.gap-2 {
                flex-wrap: wrap;
            }
            
            .mode-btn {
                flex: 1;
                min-width: 100px;
                font-size: 0.75rem;
                padding: 0.5rem 0.5rem;
            }
            
            .grid.md\\:grid-cols-3 {
                grid-template-columns: 1fr !important;
            }
            
            .grid.md\\:grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            
            .md\\:col-span-2 {
                grid-column: span 1 !important;
            }
            
            .card {
                padding: 1rem !important;
            }
            
            /* Fix identity tab cards */
            #identity-tab .card.p-4.flex.items-center.justify-between {
                flex-direction: column;
                align-items: flex-start !important;
                gap: 0.75rem;
            }
            
            #identity-tab .card.p-4.flex.items-center.justify-between button {
                align-self: flex-end;
            }
            
            #identity-tab .flex.items-center.justify-between {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            #identity-tab .font-mono {
                font-size: 0.7rem;
                word-break: break-all;
            }
            
            #identity-tab pre {
                font-size: 0.65rem;
                max-height: 200px;
            }
            
            #identity-tab .flex.gap-2 {
                flex-direction: column;
                width: 100%;
            }
            
            #identity-tab .flex.gap-2 button {
                width: 100%;
            }
            
            /* Contact tab cards */
            #contact-tab .grid.md\\:grid-cols-3 .card {
                padding: 0.75rem !important;
            }
            
            #contact-tab .text-lg {
                font-size: 1rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .navbar .max-w-5xl {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .pill {
                font-size: 0.65rem;
                padding: 0.2rem 0.5rem;
            }
            
            .btn-primary, .btn-secondary {
                font-size: 0.75rem;
                padding: 0.5rem 0.75rem;
            }
            
            h2 {
                font-size: 1.25rem;
            }
            
            .text-2xl {
                font-size: 1.25rem;
            }
            
            #identity-tab .text-lg {
                font-size: 1rem;
            }
            
            #identity-tab .font-mono {
                font-size: 0.65rem;
            }
        }
        
        /* Hide Digital ID tab when not logged in */
        .digital-id-tab {
            display: none;
        }
        
        .digital-id-tab.show {
            display: inline-flex;
        }
        
        /* User menu styles */
        .user-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .user-menu-btn {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .user-menu-btn:hover {
            opacity: 0.9;
        }
        
        .dropdown-menu {
            position: absolute;
            top: calc(100% + 0.5rem);
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            min-width: 180px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
            z-index: 1000;
        }
        
        .user-dropdown.active .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            transition: background 0.2s;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .dropdown-item:hover {
            background: var(--bg-surface);
        }
        
        .dropdown-item:first-child {
            border-radius: 0.75rem 0.75rem 0 0;
        }
        
        .dropdown-item:last-child {
            border-radius: 0 0 0.75rem 0.75rem;
        }
        
        .dropdown-divider {
            height: 1px;
            background: var(--border-color);
            margin: 0.25rem 0;
        }
        
        .dropdown-item.danger {
            color: #da1e28;
        }
        
        .dropdown-item.danger:hover {
            background: #fff1f1;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="max-w-5xl mx-auto px-6">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="h-8 w-8 rounded-xl grid place-items-center font-bold" style="background: var(--ibm-blue-60); color: white;">V</div>
                    <div class="font-semibold">VeriTrust</div>
                </div>
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="flex items-center gap-2">
                    <button class="nav-tab btn-secondary" data-tab="verify">Verify Content</button>
                    <button class="nav-tab btn-secondary digital-id-tab" data-tab="identity">Digital ID</button>
                    <button class="nav-tab btn-secondary" data-tab="about">About Us</button>
                    <button class="nav-tab btn-secondary" data-tab="Education">Education</button>
                    <button class="nav-tab btn-secondary" data-tab="contact">Ask VeriTrust</button>
                    <button class="nav-tab btn-primary" id="login-btn-desktop">Login</button>
                    <div class="user-dropdown" id="user-dropdown-desktop" style="display: none;">
                        <button class="flex items-center justify-between btn-primary user-menu-btn" id="user-menu-desktop">
                            <i class="fas fa-user-circle"></i>
                            <span class="user-name"></span>
                            <i class="fas fa-chevron-down" style="font-size: 0.7em;"></i>
                        </button>
                        <div class="dropdown-menu">
                            <div class="dropdown-item" style="pointer-events: none; color: var(--text-secondary);">
                                <i class="fas fa-user"></i>
                                <span class="user-email"></span>
                            </div>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item danger" id="logout-link-desktop">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <button class="nav-tab btn-secondary" data-tab="verify">Verify Content</button>
        <button class="nav-tab btn-secondary digital-id-tab" data-tab="identity">Digital ID</button>
        <button class="nav-tab btn-secondary" data-tab="about">About Us</button>
        <button class="nav-tab btn-secondary" data-tab="Education">Education</button>
        <button class="nav-tab btn-secondary" data-tab="contact">Ask VeriTrust</button>
        <button class="nav-tab btn-primary" id="login-btn-mobile">Login</button>
        <div class="user-dropdown" id="user-dropdown-mobile" style="display: none;">
            <button class="flex items-center justify-between btn-primary user-menu-btn" id="user-menu-mobile">
                <i class="fas fa-user-circle"></i>
                <span class="user-name"></span>
                <i class="fas fa-chevron-down" style="font-size: 0.7em;"></i>
            </button>
            <div class="dropdown-menu">
                <div class="dropdown-item" style="pointer-events: none; color: var(--text-secondary);">
                    <i class="fas fa-user"></i>
                    <span class="user-email"></span>
                </div>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item danger" id="logout-link-mobile">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main>
        <!-- Verify Tab -->
        <div id="verify-tab" class="tab-content active">
            <section class="w-full max-w-5xl mx-auto p-6">
                <div class="flex items-center justify-between gap-4 mb-4">
                    <div>
                        <h2 class="text-2xl font-semibold tracking-tight">Verify online content</h2>
                        <p class="text-sm mt-1" style="color: var(--text-secondary)">Check if a piece of content was likely AI-generated and see provenance & ownership signals.</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="pill">Beta</span>
                        <span class="pill">Client-side demo</span>
                    </div>
                </div>
                <div class="card p-6">
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="md:col-span-2 space-y-4">
                            <div class="flex gap-2">
                                <button class="mode-btn btn-secondary" data-mode="text">Paste Text</button>
                                <button class="mode-btn btn-secondary" data-mode="url">URL</button>
                                <button class="mode-btn btn-secondary" data-mode="file">Upload File</button>
                            </div>

                            <!-- Text Mode -->
                            <div id="text-mode" class="verify-mode">
                                <label class="block">
                                    <div class="text-sm mb-1" style="color: var(--text-secondary)">Text</div>
                                    <textarea id="verify-text" class="input-field" rows="10" placeholder="Paste the text snippet here..."></textarea>
                                    <div class="text-xs mt-1" style="color: var(--text-secondary)">Pro tip: include any content-credential markers or signatures if present.</div>
                                </label>
                            </div>

                            <!-- URL Mode -->
                            <div id="url-mode" class="verify-mode" style="display: none;">
                                <label class="block">
                                    <div class="text-sm mb-1" style="color: var(--text-secondary)">Public URL</div>
                                    <input id="verify-url" type="url" class="input-field" placeholder="https://example.com/article">
                                    <div class="text-xs mt-1" style="color: var(--text-secondary)">We will check metadata hints and known publisher signals.</div>
                                </label>
                            </div>

                            <!-- File Mode -->
                            <div id="file-mode" class="verify-mode" style="display: none;">
                                <label class="block">
                                    <div class="text-sm mb-1" style="color: var(--text-secondary)">Select file</div>
                                    <input id="verify-file" type="file" class="input-field" accept="text/plain,application/pdf,image/*,audio/*,video/*">
                                    <div class="text-xs mt-1" style="color: var(--text-secondary)">Videos, music, images, PDFs, and text supported (demo extracts metadata only).</div>
                                </label>
                            </div>

                            <div class="flex items-center gap-2 pt-2">
                                <button id="run-verify" class="btn-primary">Run Verification</button>
                                <span id="file-info" class="pill" style="display: none;"></span>
                            </div>

                            <div id="verify-error" class="text-sm text-red-400" style="display: none;"></div>
                        </div>

                        <div class="space-y-4">
                            <div class="card p-4">
                                <div class="text-sm font-medium mb-2">How it works</div>
                                <ul class="text-sm list-disc ml-5 space-y-1" style="color: var(--text-secondary)">
                                    <li>Combine watermark detectors, content credentials (C2PA), and model forensic signals.</li>
                                    <li>Ownership via signed attestations (passkeys), device-bound keys, or platform proofs.</li>
                                    <li>Zero-retention demo: analysis runs in-browser.</li>
                                </ul>
                            </div>
                            <div id="verify-results-container">
                                <div class="card p-4">
                                    <div class="text-sm" style="color: var(--text-secondary)">Results will appear here after verification.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Architecture Section -->
            <section class="w-full max-w-5xl mx-auto p-6">
                <div class="mb-4">
                    <h2 class="text-2xl font-semibold tracking-tight">Reference architecture</h2>
                    <p class="text-sm mt-1" style="color: var(--text-secondary)">Pluggable signals, identity attestations, zero-retention by default.</p>
                </div>
                <div class="card p-6">
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="card p-4">
                            <div class="font-medium">1) Provenance</div>
                            <ul class="text-sm list-disc ml-5 mt-2 space-y-1" style="color: var(--text-secondary)">
                                <li>C2PA / Content Credentials extraction</li>
                                <li>Platform-issued attestations (creator handles, device keys)</li>
                                <li>Signature verification & chain of custody</li>
                            </ul>
                        </div>
                        <div class="card p-4">
                            <div class="font-medium">2) AI-ness</div>
                            <ul class="text-sm list-disc ml-5 mt-2 space-y-1" style="color: var(--text-secondary)">
                                <li>Watermark detectors (vendor-specific, open)</li>
                                <li>Model forensics (stylometry, spectral, edit distance)</li>
                                <li>Cross-modal heuristics (audio/video/text)</li>
                            </ul>
                        </div>
                        <div class="card p-4">
                            <div class="font-medium">3) Ownership</div>
                            <ul class="text-sm list-disc ml-5 mt-2 space-y-1" style="color: var(--text-secondary)">
                                <li>Passkey-backed signing for creators</li>
                                <li>Axiam face sign-in as identity oracle</li>
                                <li>Dispute workflows & human review</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Digital ID Tab -->
        <div id="identity-tab" class="tab-content">
            <section class="w-full max-w-5xl mx-auto p-6">
                <div class="mb-4">
                    <h2 class="text-2xl font-semibold tracking-tight">Digital ID</h2>
                    <p class="text-sm mt-1" style="color: var(--text-secondary)">Create a DID, verify identity with Axiam Face Signâ€‘In, and sign your content.</p>
                </div>
                <div class="card p-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <!-- Handle -->
                            <div class="card p-4 flex items-center justify-between">
                                <div>
                                    <div class="text-sm" style="color: var(--text-secondary)">Handle</div>
                                    <div class="text-lg font-semibold" id="user-handle">@your.handle</div>
                                </div>
                                <button id="edit-handle" class="btn-primary">Edit</button>
                            </div>

                            <!-- Axiam Face Sign-In -->
                            <div class="card p-4 space-y-3">
                                <div class="flex items-center justify-between">
                                    <div class="font-medium">Axiam Face Signâ€‘In</div>
                                    <span id="axiam-badge" class="text-xs px-2 py-1 rounded-full border" style="color: #8d8d8d; border-color: #8d8d8d;">Not signed in</span>
                                </div>
                                <div id="axiam-container" class="rounded-lg border border-dashed p-4" style="border-color: #525252;">
                                    <div style="color: var(--text-secondary)">Axiam widget mounts here when SDK is present. Using mocked flow if SDK is absent.</div>
                                </div>
                                <div class="flex gap-2">
                                    <button id="start-axiam" class="btn-primary">Start Face Signâ€‘In</button>
                                </div>
                            </div>

                            <!-- DID -->
                            <div class="card p-4 space-y-2">
                                <div class="text-sm" style="color: var(--text-secondary)">DID</div>
                                <div id="did-display" class="font-mono break-all text-sm">â€” (none yet)</div>
                                <div class="flex gap-2">
                                    <button id="create-did" class="btn-primary">Create DID</button>
                                    <button id="copy-did" class="btn-secondary" style="display: none;">Copy DID</button>
                                </div>
                            </div>

                            <!-- Public Key -->
                            <div class="card p-4 space-y-2">
                                <div class="text-sm" style="color: var(--text-secondary)">Public Key (JWK)</div>
                                <pre id="pub-key-display" class="text-xs rounded-lg p-2 overflow-auto max-h-48" style="background: var(--bg-surface); color: #e0e0e0;">â€”</pre>
                                <button id="copy-pubkey" class="btn-secondary" style="display: none;">Copy Public Key</button>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <!-- Signature Tag -->
                            <div class="card p-4">
                                <div class="text-sm mb-2" style="color: var(--text-secondary)">Generate a signature tag bound to your DID (and Axiam subject if verified).</div>
                                <div class="flex items-center gap-2">
                                    <button id="gen-signature" class="btn-primary">Generate Signature Tag</button>
                                    <button id="copy-signature" class="btn-secondary" style="display: none;">Copy Tag</button>
                                </div>
                                <div id="signature-tag-display" class="mt-3 text-sm" style="color: var(--ibm-blue-30); display: none;">
                                    Use this tag in your content: <span id="signature-tag" class="font-mono" style="color: white;"></span>
                                </div>
                            </div>
                            <div id="identity-status" class="text-sm" style="color: var(--text-secondary); display: none;"></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- About Us Tab -->
        <div id="about-tab" class="tab-content">
            <section class="w-full max-w-5xl mx-auto p-6">
                <!-- Hero Section -->
                <div class="mb-8">
                    <h2 class="text-3xl font-bold tracking-tight">About VeriTrust</h2>
                    <p class="text-lg mt-3" style="color: var(--text-secondary)">Building trust in the digital age through verifiable content and identity.</p>
                </div>

                <!-- Mission & Vision -->
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="card p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="h-12 w-12 rounded-xl grid place-items-center" style="background: var(--ibm-blue-60); color: white;">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold">Our Mission</h3>
                        </div>
                        <p style="color: var(--text-secondary)">
                            To provide cutting-edge tools that enable individuals and organizations to verify the authenticity of digital content, 
                            protect intellectual property, and establish trusted digital identities in an era of AI-generated media.
                        </p>
                    </div>

                    <div class="card p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="h-12 w-12 rounded-xl grid place-items-center" style="background: var(--ibm-blue-60); color: white;">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold">Our Vision</h3>
                        </div>
                        <p style="color: var(--text-secondary)">
                            A world where digital content can be trusted, creators are properly attributed, and identity verification 
                            is seamless, secure, and privacy-preserving for everyone.
                        </p>
                    </div>
                </div>

                <!-- What We Do -->
                <div class="card p-6 mb-8">
                    <h3 class="text-2xl font-semibold mb-4">What We Do</h3>
                    <div class="space-y-4">
                        <div class="flex gap-4">
                            <div class="flex-shrink-0 mt-1">
                                <div class="h-8 w-8 rounded-lg grid place-items-center" style="background: var(--ibm-blue-30); color: white;">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-1">Content Verification</h4>
                                <p class="text-sm" style="color: var(--text-secondary)">
                                    Advanced detection systems combining watermark analysis, C2PA content credentials, and forensic signals 
                                    to identify AI-generated content and verify authenticity.
                                </p>
                            </div>
                        </div>

                        <div class="flex gap-4">
                            <div class="flex-shrink-0 mt-1">
                                <div class="h-8 w-8 rounded-lg grid place-items-center" style="background: var(--ibm-blue-30); color: white;">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M18 8a6 6 0 01-7.743 5.743L10 14l-1 1-1 1H6v2H2v-4l4.257-4.257A6 6 0 1118 8zm-6-4a1 1 0 100 2 2 2 0 012 2 1 1 0 102 0 4 4 0 00-4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-1">Digital Identity</h4>
                                <p class="text-sm" style="color: var(--text-secondary)">
                                    Decentralized identity (DID) solutions integrated with biometric authentication (Axiam Face Sign-In) 
                                    and cryptographic signatures for secure, privacy-preserving identity verification.
                                </p>
                            </div>
                        </div>

                        <div class="flex gap-4">
                            <div class="flex-shrink-0 mt-1">
                                <div class="h-8 w-8 rounded-lg grid place-items-center" style="background: var(--ibm-blue-30); color: white;">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                        <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-1">Ownership & Attribution</h4>
                                <p class="text-sm" style="color: var(--text-secondary)">
                                    Signed attestations and device-bound keys that enable creators to prove ownership and maintain 
                                    provenance chains for their digital content.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Core Principles -->
                <div class="card p-6 mb-8">
                    <h3 class="text-2xl font-semibold mb-4">Core Principles</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="text-center p-4">
                            <div class="text-3xl mb-2">ðŸ”’</div>
                            <h4 class="font-semibold mb-2">Privacy First</h4>
                            <p class="text-sm" style="color: var(--text-secondary)">
                                Zero-retention by default. Your data stays in your browser.
                            </p>
                        </div>
                        <div class="text-center p-4">
                            <div class="text-3xl mb-2">ðŸ”“</div>
                            <h4 class="font-semibold mb-2">Open Standards</h4>
                            <p class="text-sm" style="color: var(--text-secondary)">
                                Built on W3C DIDs, C2PA, and open cryptographic protocols.
                            </p>
                        </div>
                        <div class="text-center p-4">
                            <div class="text-3xl mb-2">âš¡</div>
                            <h4 class="font-semibold mb-2">User Empowerment</h4>
                            <p class="text-sm" style="color: var(--text-secondary)">
                                You control your identity and content verification.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Technology Stack -->
                <div class="card p-6 mb-8">
                    <h3 class="text-2xl font-semibold mb-4">Technology Stack</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold mb-2" style="color: var(--ibm-blue-60)">Security & Cryptography</h4>
                            <ul class="text-sm space-y-1" style="color: var(--text-secondary)">
                                <li>â€¢ WebCrypto API (ECDSA P-256)</li>
                                <li>â€¢ SHA-256 fingerprinting</li>
                                <li>â€¢ JWK (JSON Web Keys)</li>
                                <li>â€¢ Client-side key generation</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2" style="color: var(--ibm-blue-60)">Identity & Standards</h4>
                            <ul class="text-sm space-y-1" style="color: var(--text-secondary)">
                                <li>â€¢ W3C Decentralized Identifiers (DIDs)</li>
                                <li>â€¢ C2PA Content Credentials</li>
                                <li>â€¢ Passkey integration</li>
                                <li>â€¢ Biometric authentication (Axiam)</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2" style="color: var(--ibm-blue-60)">AI Detection</h4>
                            <ul class="text-sm space-y-1" style="color: var(--text-secondary)">
                                <li>â€¢ Watermark detection algorithms</li>
                                <li>â€¢ Model forensic analysis</li>
                                <li>â€¢ Metadata extraction</li>
                                <li>â€¢ Multi-modal verification</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2" style="color: var(--ibm-blue-60)">Privacy & Storage</h4>
                            <ul class="text-sm space-y-1" style="color: var(--text-secondary)">
                                <li>â€¢ Browser LocalStorage</li>
                                <li>â€¢ Zero server retention</li>
                                <li>â€¢ Client-side processing</li>
                                <li>â€¢ Encrypted key storage</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Team & Contact -->
                <div class="card p-6">
                    <h3 class="text-2xl font-semibold mb-4">Get in Touch</h3>
                    <p class="mb-4" style="color: var(--text-secondary)">
                        VeriTrust is committed to advancing digital trust through innovative technology. Whether you're a content creator, 
                        publisher, enterprise, or researcher, we'd love to hear from you.
                    </p>
                    <div class="flex flex-wrap gap-3">
                        <a href="#" onclick="event.preventDefault(); document.querySelector('[data-tab=contact]').click();" class="btn-primary">
                            Contact Us
                        </a>
                        <a href="#" onclick="event.preventDefault(); document.querySelector('[data-tab=Education]').click();" class="btn-secondary">
                            View Research
                        </a>
                    </div>
                </div>
            </section>
        </div>

        <!-- Education Tab -->
        <div id="Education-tab" class="tab-content">
            <section class="w-full max-w-5xl mx-auto p-6">
                <div class="mb-4">
                    <h2 class="text-2xl font-semibold tracking-tight">Education</h2>
                    <p class="text-sm mt-1" style="color: var(--text-secondary)">Research, whitepapers, and technical notes.</p>
                </div>
                <div class="card p-6">
                    <div id="Education-list" class="text-sm" style="color: var(--text-secondary)">Loadingâ€¦</div>
                </div>
            </section>
        </div>

        <!-- Contact Tab -->
        <div id="contact-tab" class="tab-content">
            <section class="w-full max-w-5xl mx-auto p-6">
                <div class="mb-4">
                    <h2 class="text-2xl font-semibold tracking-tight">Ask VeriTrust</h2>
                    <p class="text-sm mt-1" style="color: var(--text-secondary)">We'd love to hear from you.</p>
                </div>
                <div class="card p-6">
                    <form id="contact-form" class="grid md:grid-cols-2 gap-4">
                        <label class="block">
                            <div class="text-sm mb-1" style="color: var(--text-secondary)">Name</div>
                            <input id="contact-name" type="text" class="input-field" placeholder="Ada Lovelace">
                        </label>
                        <label class="block">
                            <div class="text-sm mb-1" style="color: var(--text-secondary)">Email</div>
                            <input id="contact-email" type="email" class="input-field" placeholder="ada@example.com">
                        </label>
                        <label class="block md:col-span-2">
                            <div class="text-sm mb-1" style="color: var(--text-secondary)">Message</div>
                            <textarea id="contact-message" class="input-field" rows="6" placeholder="Tell us about your use-case or questionâ€¦"></textarea>
                        </label>
                        <div class="md:col-span-2 flex items-center gap-2">
                            <button type="submit" class="btn-primary" id="contact-submit">Send message</button>
                            <span id="contact-success" class="text-sm text-green-400" style="display: none;">Thanks! We'll get back to you soon.</span>
                            <span id="contact-error" class="text-sm text-red-400" style="display: none;"></span>
                        </div>
                    </form>
                    <div class="mt-6 grid md:grid-cols-3 gap-4 text-sm">
                        <div class="card p-4">
                            <div class="text-xs uppercase tracking-wide" style="color: var(--text-secondary)">Email</div>
                            <div class="text-lg font-semibold mt-1 break-all">hello@veritrust.example</div>
                        </div>
                        <div class="card p-4">
                            <div class="text-xs uppercase tracking-wide" style="color: var(--text-secondary)">Security</div>
                            <div class="text-lg font-semibold mt-1 break-all">security@veritrust.example</div>
                        </div>
                        <div class="card p-4">
                            <div class="text-xs uppercase tracking-wide" style="color: var(--text-secondary)">Status</div>
                            <div class="text-lg font-semibold mt-1 break-all">
                                <a class="underline" href="#" style="color: var(--ibm-blue-30)">status.veritrust.example</a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="max-w-5xl mx-auto px-6 py-10 text-sm" style="color: var(--text-secondary)">
        <div class="border-t pt-6 flex items-center justify-between" style="border-color: var(--border-color)">
            <div>Â© <span id="current-year"></span> VeriTrust Labs</div>
            <div class="flex items-center gap-4">
                <a class="underline" href="#" style="color: var(--ibm-blue-30)">Privacy</a>
                <a class="underline" href="#" style="color: var(--ibm-blue-30)">Terms</a>
            </div>
        </div>
    </footer>

    <script>
        $(document).ready(function() {
            // ============================================================
            // Authentication Helper Functions
            // ============================================================
            function setCookie(name, value, days = 7) {
                const expires = new Date();
                expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
                document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
            }
            
            function getCookie(name) {
                const nameEQ = name + "=";
                const ca = document.cookie.split(';');
                for(let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            }
            
            function deleteCookie(name) {
                document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`;
            }
            
            function isUserLoggedIn() {
                return getCookie('veritrust_user') !== null;
            }
            
            function getUserFromCookie() {
                // Try to get from cookie first
                const userData = getCookie('veritrust_user');
                if (userData) {
                    try {
                        return JSON.parse(decodeURIComponent(userData));
                    } catch (e) {
                        console.error('Error parsing cookie:', e);
                    }
                }
                
                // Fallback to localStorage
                const localUser = localStorage.getItem('veritrust_current_user');
                if (localUser) {
                    try {
                        return JSON.parse(localUser);
                    } catch (e) {
                        console.error('Error parsing localStorage:', e);
                    }
                }
                
                return null;
            }
            
            function updateLoginButton(userData) {
                if (userData) {
                    // Hide login buttons
                    $('#login-btn-desktop, #login-btn-mobile').hide();
                    
                    // Show user dropdowns
                    $('#user-dropdown-desktop, #user-dropdown-mobile').show();
                    
                    // Update user name and email in dropdowns
                    const displayName = userData.name || userData.email;
                    const shortName = displayName.length > 17 ? displayName.substring(0, 14) + '...' : displayName;
                    
                    $('.user-dropdown .user-name').text(shortName);
                    $('.user-dropdown .user-email').text(userData.email);
                    
                    // Toggle dropdown on button click
                    $('#user-menu-desktop, #user-menu-mobile').off('click').click(function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        $(this).parent('.user-dropdown').toggleClass('active');
                    });
                    
                    // Handle logout link click
                    $('#logout-link-desktop, #logout-link-mobile').off('click').click(function(e) {
                        e.preventDefault();
                        if (confirm(`Logout from ${userData.name || userData.email}?`)) {
                            deleteCookie('veritrust_user');
                            // Keep localStorage data, only remove cookie
                            $('.digital-id-tab').removeClass('show');
                            location.reload();
                        }
                    });
                    
                    // Close dropdown when clicking outside
                    $(document).off('click.dropdown').on('click.dropdown', function(e) {
                        if (!$(e.target).closest('.user-dropdown').length) {
                            $('.user-dropdown').removeClass('active');
                        }
                    });
                } else {
                    // Show login buttons
                    $('#login-btn-desktop, #login-btn-mobile').show();
                    
                    // Hide user dropdowns
                    $('#user-dropdown-desktop, #user-dropdown-mobile').hide();
                    
                    // Setup login button click handlers
                    $('#login-btn-desktop, #login-btn-mobile').off('click').click(function() {
                        window.location.href = 'Login.html';
                    });
                    
                    // Remove dropdown click handler
                    $(document).off('click.dropdown');
                }
            }
            
            // Check login status on page load
            const currentUser = getUserFromCookie();
            console.log('Current user from cookie:', currentUser); // DEBUG
            
            if (currentUser) {
                console.log('User logged in:', currentUser.name, currentUser.email); // DEBUG
                $('.digital-id-tab').addClass('show');
                updateLoginButton(currentUser);
            } else {
                console.log('No user logged in'); // DEBUG
                // Initialize login button click handlers for non-logged-in users
                $('#login-btn-desktop, #login-btn-mobile').click(function() {
                    window.location.href = 'Login.html';
                });
            }
            
            // ============================================================
            // Global State
            // ============================================================
            let currentTab = 'verify';
            let verifyMode = 'text';
            let axiamState = { state: 'idle', subject: null, token: null };
            let userDID = localStorage.getItem('veritrust_did') || '';
            let userHandle = localStorage.getItem('veritrust_handle') || '@your.handle';
            let pubKeyJwk = null;
            let privKeyJwk = null;

            // Load saved keys
            const savedPubKey = localStorage.getItem('veritrust_pub');
            const savedPrivKey = localStorage.getItem('veritrust_priv');
            if (savedPubKey) pubKeyJwk = JSON.parse(savedPubKey);
            if (savedPrivKey) privKeyJwk = JSON.parse(savedPrivKey);

            // Initialize
            $('#current-year').text(new Date().getFullYear());
            $('#user-handle').text(userHandle);
            if (userDID) {
                $('#did-display').text(userDID);
                $('#copy-did').show();
                $('#create-did').text('Regenerate Keys');
            }
            if (pubKeyJwk) {
                $('#pub-key-display').text(JSON.stringify(pubKeyJwk, null, 2));
                $('#copy-pubkey').show();
            }

            // ============================================================
            // Helper Functions
            // ============================================================
            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            async function subtleSha256Hex(input) {
                if (window.crypto && window.crypto.subtle) {
                    const enc = new TextEncoder().encode(input);
                    const buf = await window.crypto.subtle.digest('SHA-256', enc);
                    return Array.from(new Uint8Array(buf))
                        .map(b => b.toString(16).padStart(2, '0'))
                        .join('');
                }
                // Fallback
                let h = 0;
                for (let i = 0; i < input.length; i++) {
                    h = (h * 31 + input.charCodeAt(i)) >>> 0;
                }
                return h.toString(16);
            }

            const b64u = {
                encode: (buf) => {
                    const b = typeof buf === 'string' ? new TextEncoder().encode(buf) : new Uint8Array(buf);
                    let str = btoa(String.fromCharCode(...b));
                    return str.replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
                },
                decode: (s) => {
                    s = s.replace(/-/g, '+').replace(/_/g, '/');
                    while (s.length % 4) s += '=';
                    const bin = atob(s);
                    const bytes = new Uint8Array(bin.length);
                    for (let i = 0; i < bin.length; i++) bytes[i] = bin.charCodeAt(i);
                    return bytes;
                }
            };

            async function importPubKeyJwk(jwk) {
                return await window.crypto.subtle.importKey(
                    'jwk',
                    jwk,
                    { name: 'ECDSA', namedCurve: 'P-256' },
                    true,
                    ['verify']
                );
            }

            async function verifyVTSignature({ fingerprint, tag }) {
                const m = tag.match(/^\[VT1:([^:]+):([A-Za-z0-9_-]+)\]$/);
                if (!m) return { ok: false };
                const did = m[1];
                const sig = b64u.decode(m[2]);
                const registry = JSON.parse(localStorage.getItem('veritrust_registry') || '{}');
                const rec = registry[did];
                if (!rec || !rec.publicKeyJwk) return { ok: false, reason: 'No public key found for DID' };
                const pub = await importPubKeyJwk(rec.publicKeyJwk);
                const msg = new TextEncoder().encode(fingerprint);
                const ok = await window.crypto.subtle.verify(
                    { name: 'ECDSA', hash: 'SHA-256' },
                    pub,
                    sig,
                    msg
                );
                return { ok, did, handle: rec.handle || did };
            }

            // ============================================================
            // Mock API
            // ============================================================
            const mockAPI = {
                verify: async function(payload) {
                    await sleep(700);
                    let kind = payload.type;
                    let aiLikelihood = 0.33;
                    let provenance = { hasSignature: false, scheme: null, signer: null };
                    let ownership = { verified: false, did: null, handle: null };

                    if (kind === 'text') {
                        const text = payload.content || '';
                        const low = text.toLowerCase();
                        const len = Math.min(0.4, Math.max(0, (text.length - 800) / 4000));
                        const hits = [/as an ai/, /large language model/, /neural network/]
                            .reduce((n, re) => n + (re.test(low) ? 1 : 0), 0);
                        aiLikelihood = Math.min(0.95, 0.25 + len + hits * 0.18);
                        if (/c2pa:|content-cred:|veritrust-sig:/i.test(low)) {
                            provenance = { hasSignature: true, scheme: 'Content Credentials', signer: '@publisher' };
                        }
                    }

                    if (kind === 'url') {
                        const url = payload.url || '';
                        aiLikelihood = /\.ai\//.test(url) || /ai\./.test(url) ? 0.7 : 0.42;
                        if (/c2pa|cred|sig|proof/i.test(url)) {
                            provenance = { hasSignature: true, scheme: 'C2PA', signer: 'Publisher CDN' };
                        }
                    }

                    if (kind === 'file') {
                        const f = payload.file;
                        aiLikelihood = (f && f.type && (f.type.startsWith('audio/') || f.type.startsWith('video/'))) ? 0.55 : 0.38;
                    }

                    const fingerprint = await subtleSha256Hex(
                        kind === 'text' ? payload.content :
                        kind === 'url' ? payload.url :
                        (payload.file ? payload.file.name : 'file') + (payload.file ? payload.file.size : 0)
                    );

                    if (kind === 'text') {
                        const tagMatch = payload.content.match(/\[VT1:[^\]]+\]/);
                        if (tagMatch) {
                            try {
                                const out = await verifyVTSignature({ fingerprint, tag: tagMatch[0] });
                                if (out.ok) {
                                    ownership = { verified: true, did: out.did, handle: out.handle };
                                }
                            } catch (e) {}
                        }
                    }

                    return {
                        ok: true,
                        data: {
                            aiLikelihood,
                            fingerprint,
                            provenance,
                            ownership,
                            ownerCandidates: [
                                { handle: '@alice', score: 0.62 },
                                { handle: '@bob', score: 0.27 },
                                { handle: 'Unknown', score: 0.11 }
                            ],
                            modelHints: [
                                { label: 'LLM-like phrasing', weight: 0.3 },
                                { label: 'Repetitive cadence', weight: 0.2 },
                                { label: 'No EXIF/editor trail', weight: 0.15 }
                            ]
                        }
                    };
                },

                Education: async function() {
                    await sleep(250);
                    return {
                        ok: true,
                        data: [
                            {
                                title: 'VeriTrust: Provenance-first AI Content Verification',
                                venue: 'VeriTrust Labs',
                                year: 2025,
                                link: '#',
                                summary: 'Combine C2PA, watermarking, and identity attestations.'
                            },
                            {
                                title: 'Axiam + DID: Binding Faces to Keys',
                                venue: 'Preprint',
                                year: 2025,
                                link: '#',
                                summary: 'Face sign-in as an identity oracle for creator DIDs.'
                            },
                            {
                                title: 'Watermarks Under Attack',
                                venue: 'Workshop on Trust & Safety',
                                year: 2024,
                                link: '#',
                                summary: 'Stress tests across edits and transcodings.'
                            }
                        ]
                    };
                },

                contact: async function(payload) {
                    await sleep(450);
                    return { ok: true };
                }
            };

            // ============================================================
            // Tab Navigation
            // ============================================================
            
            // Hamburger menu toggle
            $('#hamburger').click(function() {
                $('#mobileMenu').toggleClass('active');
                $(this).toggleClass('active');
            });
            
            $('.nav-tab').click(function() {
                const tab = $(this).data('tab');
                switchTab(tab);
                // Close mobile menu after selection
                $('#mobileMenu').removeClass('active');
                $('#hamburger').removeClass('active');
            });

            function switchTab(tab) {
                currentTab = tab;
                $('.tab-content').removeClass('active');
                $(`#${tab}-tab`).addClass('active');
                
                $('.nav-tab').each(function() {
                    if ($(this).data('tab') === tab) {
                        $(this).addClass('btn-primary').removeClass('btn-secondary');
                    } else {
                        $(this).addClass('btn-secondary').removeClass('btn-primary');
                    }
                });

                // Load Education if switching to that tab
                if (tab === 'Education') {
                    loadEducation();
                }
            }

            // ============================================================
            // Verify Tab
            // ============================================================
            $('.mode-btn').click(function() {
                const mode = $(this).data('mode');
                verifyMode = mode;
                $('.verify-mode').hide();
                $(`#${mode}-mode`).show();
                $('.mode-btn').each(function() {
                    if ($(this).data('mode') === mode) {
                        $(this).addClass('btn-primary').removeClass('btn-secondary');
                    } else {
                        $(this).addClass('btn-secondary').removeClass('btn-primary');
                    }
                });
                $('#file-info').hide();
            });

            $('#verify-file').change(function() {
                const file = this.files[0];
                if (file) {
                    $('#file-info').text(`${file.name} Â· ${(file.size / 1024).toFixed(1)} KB`).show();
                } else {
                    $('#file-info').hide();
                }
            });

            $('#run-verify').click(async function() {
                $('#verify-error').hide();
                const btn = $(this);
                btn.prop('disabled', true).text('Verifying...');

                try {
                    let payload;
                    if (verifyMode === 'text') {
                        const text = $('#verify-text').val().trim();
                        if (!text) throw new Error('Please enter some text');
                        payload = { type: 'text', content: text };
                    } else if (verifyMode === 'url') {
                        const url = $('#verify-url').val().trim();
                        if (!url) throw new Error('Please enter a URL');
                        payload = { type: 'url', url };
                    } else if (verifyMode === 'file') {
                        const file = $('#verify-file')[0].files[0];
                        if (!file) throw new Error('Please select a file');
                        payload = { type: 'file', file: { name: file.name, size: file.size, type: file.type } };
                    }

                    const result = await mockAPI.verify(payload);
                    if (!result.ok) throw new Error('Verification failed');
                    displayVerifyResults(result.data);
                } catch (e) {
                    $('#verify-error').text(e.message || 'Something went wrong').show();
                } finally {
                    btn.prop('disabled', false).text('Run Verification');
                }
            });

            function displayVerifyResults(result) {
                const pct = Math.round((result.aiLikelihood || 0) * 100);
                const topOwner = result.ownerCandidates.slice().sort((a, b) => b.score - a.score)[0];

                let html = `
                    <div class="card p-4 space-y-4">
                        <div class="flex items-center justify-between">
                            <div class="text-sm font-medium">Verification Summary</div>
                            <span class="pill">Fingerprint</span>
                        </div>
                        
                        <!-- Gauge -->
                        <div class="w-full">
                            <div class="flex justify-between text-xs mb-1" style="color: var(--text-secondary)">
                                <span>Low</span><span>High</span>
                            </div>
                            <div class="h-3 w-full rounded-full overflow-hidden" style="background: #393939">
                                <div class="gauge-fill" style="width: ${pct}%"></div>
                            </div>
                            <div class="text-sm mt-1">AI-likeness: <span class="font-semibold">${pct}%</span></div>
                        </div>
                        
                        ${result.ownership.verified ? `
                        <div class="verified-badge">
                            <div class="text-sm font-semibold">Ownership Verified</div>
                            <div class="text-sm" style="color: var(--text-secondary)">
                                Signed by <span class="font-mono">${result.ownership.handle}</span> (${result.ownership.did})
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="grid grid-cols-1 gap-3">
                            <div class="card p-4">
                                <div class="text-xs uppercase tracking-wide" style="color: var(--text-secondary)">Content fingerprint (SHA-256)</div>
                                <div class="text-lg font-semibold mt-1 break-all">${result.fingerprint}</div>
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="card p-4">
                                    <div class="text-xs uppercase tracking-wide" style="color: var(--text-secondary)">Provenance</div>
                                    <div class="text-lg font-semibold mt-1 break-all">
                                        ${result.provenance.hasSignature ? `${result.provenance.scheme} âœ“` : 'None found'}
                                    </div>
                                </div>
                                <div class="card p-4">
                                    <div class="text-xs uppercase tracking-wide" style="color: var(--text-secondary)">Signer</div>
                                    <div class="text-lg font-semibold mt-1 break-all">${result.provenance.signer || 'â€”'}</div>
                                </div>
                            </div>
                            
                            <div class="card p-3">
                                <div class="text-xs uppercase tracking-wide mb-1" style="color: var(--text-secondary)">Ownership candidates</div>
                                <ul class="text-sm space-y-1">
                                    ${result.ownerCandidates.map(c => `
                                        <li class="flex items-center justify-between">
                                            <span>${c.handle}</span>
                                            <span style="color: var(--text-secondary)">${Math.round(c.score * 100)}%</span>
                                        </li>
                                    `).join('')}
                                </ul>
                                ${topOwner ? `
                                <div class="text-sm mt-2" style="color: var(--text-secondary)">
                                    Top guess: <span class="font-semibold" style="color: white">${topOwner.handle}</span>
                                </div>
                                ` : ''}
                            </div>
                            
                            <div class="info-section">
                                <div class="text-xs uppercase tracking-wide mb-1" style="color: var(--text-secondary)">Model hints</div>
                                <ul class="text-sm list-disc ml-5 space-y-1">
                                    ${result.modelHints.map(h => `
                                        <li>${h.label} <span style="color: var(--text-secondary)">(${Math.round(h.weight * 100)}%)</span></li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;

                $('#verify-results-container').html(html);
            }

            // ============================================================
            // Digital ID Tab
            // ============================================================
            $('#edit-handle').click(function() {
                const newHandle = prompt('Enter your handle:', userHandle);
                if (newHandle && newHandle.trim()) {
                    userHandle = newHandle.trim();
                    localStorage.setItem('veritrust_handle', userHandle);
                    $('#user-handle').text(userHandle);
                }
            });

            $('#start-axiam').click(async function() {
                try {
                    showIdentityStatus('Starting Axiam face signâ€‘inâ€¦');
                    
                    // Check if Axiam SDK is available
                    if (window.Axiam && window.Axiam.startFaceSignIn) {
                        const { subject, token } = await window.Axiam.startFaceSignIn({ 
                            container: '#axiam-container' 
                        });
                        axiamState = { state: 'verified', subject, token };
                        $('#axiam-container').html(`
                            <div style="color: var(--text-secondary)">
                                Subject: <span class="font-mono" style="color: white">${subject}</span>
                            </div>
                        `);
                        showIdentityStatus('Axiam verification successful.');
                    } else {
                        // Mock fallback
                        await sleep(1200);
                        const subject = 'axiam:sub:' + Math.random().toString(36).slice(2, 10);
                        const token = 'mock.jwt.' + Math.random().toString(36).slice(2, 8);
                        axiamState = { state: 'verified', subject, token };
                        $('#axiam-container').html(`
                            <div style="color: var(--text-secondary)">
                                Subject: <span class="font-mono" style="color: white">${subject}</span>
                            </div>
                        `);
                        showIdentityStatus('Axiam verification (mock) successful.');
                    }
                    
                    $('#axiam-badge')
                        .text('Axiam Verified')
                        .css({ color: '#24a148', borderColor: '#24a148' });
                } catch (e) {
                    axiamState = { state: 'error', subject: null, token: null };
                    showIdentityStatus('Axiam verification failed.');
                    $('#axiam-badge')
                        .text('Axiam Error')
                        .css({ color: '#fa4d56', borderColor: '#fa4d56' });
                }
            });

            $('#create-did').click(async function() {
                try {
                    showIdentityStatus('Generating keysâ€¦');
                    
                    const keyPair = await crypto.subtle.generateKey(
                        { name: 'ECDSA', namedCurve: 'P-256' },
                        true,
                        ['sign', 'verify']
                    );
                    
                    const pub = await crypto.subtle.exportKey('jwk', keyPair.publicKey);
                    const priv = await crypto.subtle.exportKey('jwk', keyPair.privateKey);
                    
                    const thumb = (await subtleSha256Hex(JSON.stringify(pub))).slice(0, 16);
                    const newDid = `did:vt:${thumb}`;
                    
                    userDID = newDid;
                    pubKeyJwk = pub;
                    privKeyJwk = priv;
                    
                    localStorage.setItem('veritrust_did', newDid);
                    localStorage.setItem('veritrust_priv', JSON.stringify(priv));
                    localStorage.setItem('veritrust_pub', JSON.stringify(pub));
                    
                    // Update registry
                    const registry = JSON.parse(localStorage.getItem('veritrust_registry') || '{}');
                    registry[newDid] = {
                        publicKeyJwk: pub,
                        handle: userHandle,
                        axiamSubject: axiamState.subject || null
                    };
                    localStorage.setItem('veritrust_registry', JSON.stringify(registry));
                    
                    $('#did-display').text(newDid);
                    $('#copy-did').show();
                    $('#create-did').text('Regenerate Keys');
                    $('#pub-key-display').text(JSON.stringify(pub, null, 2));
                    $('#copy-pubkey').show();
                    
                    showIdentityStatus('Keys created. DID ready.');
                } catch (e) {
                    showIdentityStatus('Error creating DID: ' + e.message);
                }
            });

            $('#copy-did').click(function() {
                copyToClipboard(userDID);
                showIdentityStatus('DID copied to clipboard');
            });

            $('#copy-pubkey').click(function() {
                copyToClipboard(JSON.stringify(pubKeyJwk));
                showIdentityStatus('Public key copied to clipboard');
            });

            $('#gen-signature').click(async function() {
                try {
                    if (!privKeyJwk) {
                        showIdentityStatus('No private key found. Create DID first.');
                        return;
                    }
                    
                    const fingerprint = await subtleSha256Hex(userHandle + (axiamState.subject || 'anonymous'));
                    
                    const pk = await crypto.subtle.importKey(
                        'jwk',
                        privKeyJwk,
                        { name: 'ECDSA', namedCurve: 'P-256' },
                        true,
                        ['sign']
                    );
                    
                    const msg = new TextEncoder().encode(fingerprint);
                    const sig = await crypto.subtle.sign(
                        { name: 'ECDSA', hash: 'SHA-256' },
                        pk,
                        msg
                    );
                    
                    const tag = `[VT1:${userDID}:${b64u.encode(new Uint8Array(sig))}]`;
                    
                    $('#signature-tag').text(tag);
                    $('#signature-tag-display').show();
                    $('#copy-signature').show();
                } catch (e) {
                    showIdentityStatus('Error generating signature: ' + e.message);
                }
            });

            $('#copy-signature').click(function() {
                const tag = $('#signature-tag').text();
                copyToClipboard(tag);
                showIdentityStatus('Signature tag copied to clipboard');
            });

            function showIdentityStatus(msg) {
                $('#identity-status').text(msg).show();
                setTimeout(() => {
                    if ($('#identity-status').text() === msg) {
                        $('#identity-status').fadeOut();
                    }
                }, 3000);
            }

            function copyToClipboard(text) {
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(text);
                } else {
                    // Fallback
                    const temp = $('<textarea>').val(text).appendTo('body').select();
                    document.execCommand('copy');
                    temp.remove();
                }
            }

            // ============================================================
            // Education Tab
            // ============================================================
            async function loadEducation() {
                try {
                    $('#Education-list').html('<div class="text-sm" style="color: var(--text-secondary)">Loadingâ€¦</div>');
                    
                    const result = await mockAPI.Education();
                    if (!result.ok) throw new Error('Failed to load Education');
                    
                    const html = `
                        <div class="grid md:grid-cols-2 gap-4">
                            ${result.data.map(p => `
                                <article class="card p-4 space-y-2">
                                    <h3 class="font-semibold text-lg">${p.title}</h3>
                                    <div class="text-sm" style="color: var(--text-secondary)">${p.venue} Â· ${p.year}</div>
                                    <p class="text-sm">${p.summary}</p>
                                    <div>
                                        <a href="${p.link}" class="text-sm underline" style="color: var(--ibm-blue-30)">Read</a>
                                    </div>
                                </article>
                            `).join('')}
                        </div>
                    `;
                    
                    $('#Education-list').html(html);
                } catch (e) {
                    $('#Education-list').html(`<div class="text-sm text-red-400">${e.message}</div>`);
                }
            }

            // ============================================================
            // Contact Tab
            // ============================================================
            $('#contact-form').submit(async function(e) {
                e.preventDefault();
                
                const name = $('#contact-name').val().trim();
                const email = $('#contact-email').val().trim();
                const message = $('#contact-message').val().trim();
                
                if (name.length < 2 || !/.+@.+\..+/.test(email) || message.length < 10) {
                    $('#contact-error').text('Please fill all fields correctly').show();
                    return;
                }
                
                const btn = $('#contact-submit');
                btn.prop('disabled', true).text('Sendingâ€¦');
                $('#contact-error, #contact-success').hide();
                
                try {
                    const result = await mockAPI.contact({ name, email, message });
                    if (!result.ok) throw new Error('Failed to send. Please try again.');
                    
                    $('#contact-success').show();
                    $('#contact-name, #contact-email, #contact-message').val('');
                } catch (e) {
                    $('#contact-error').text(e.message).show();
                } finally {
                    btn.prop('disabled', false).text('Send message');
                }
            });

            // ============================================================
            // Self Tests
            // ============================================================
            (function runSelfTests() {
                try {
                    const msg = new TextEncoder().encode('hello');
                    const enc = b64u.encode(msg);
                    const dec = b64u.decode(enc);
                    console.assert(
                        dec.length === msg.length && Array.from(dec).every((v, i) => v === msg[i]),
                        'b64u roundtrip failed'
                    );
                    
                    const ok = /^\[VT1:([^:]+):([A-Za-z0-9_-]+)\]$/.test('[VT1:did:abcd_-123]');
                    console.assert(ok, 'VT tag regex mismatch');
                    
                    console.log('âœ“ Self-tests passed');
                } catch (e) {
                    console.warn('Self-tests encountered an error (non-fatal):', e);
                }
            })();
        });
    </script>
</body>
</html>
